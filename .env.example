# Core runtime
DATABASE_URL=postgresql://recsys:recsys_change_me@localhost:5432/recsys
DB_INIT_ON_STARTUP=true
DB_POOL_MIN_SIZE=1
DB_POOL_MAX_SIZE=10

# API runtime
UVICORN_WORKERS=2
RECO_ASYNC_IMPRESSION_LOGGING=true
RECO_BACKGROUND_SHUTDOWN_TIMEOUT_SEC=5

# Kafka dual-write
KAFKA_DUAL_WRITE_ENABLED=true
# If API runs on host use localhost:29092, in docker-compose use kafka:9092
KAFKA_BOOTSTRAP_SERVERS=localhost:29092
KAFKA_TOPIC_IMPRESSIONS=recsys.impressions.v1
KAFKA_TOPIC_WATCHES=recsys.watches.v1
KAFKA_CLIENT_ID=recsys-api
KAFKA_REQUEST_TIMEOUT_MS=15000

# Metrics
PROMETHEUS_METRICS_ENABLED=false
METRICS_HOST=0.0.0.0
METRICS_PORT=9108

# Online serving cache
ONLINE_CACHE_ENABLED=true
ONLINE_CACHE_BACKEND=memory
ONLINE_CACHE_STRICT_BACKEND=false
ONLINE_CACHE_REDIS_URL=redis://localhost:6379/0
ONLINE_CACHE_REDIS_TIMEOUT_SEC=1
ONLINE_CACHE_MEMORY_MAX_KEYS=100000
ONLINE_CACHE_HISTORY_TTL_SEC=20
ONLINE_CACHE_RELATED_TTL_SEC=30
ONLINE_CACHE_POPULARITY_TTL_SEC=5

# Postgres (for docker-compose)
POSTGRES_DB=recsys
POSTGRES_USER=recsys
POSTGRES_PASSWORD=recsys_change_me
